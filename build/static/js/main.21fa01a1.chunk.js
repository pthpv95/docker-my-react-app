(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{113:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},115:function(e,t,n){e.exports=n.p+"static/media/graphql-icon.2347dbbf.png"},130:function(e,t,n){e.exports=n(203)},135:function(e,t,n){},138:function(e,t,n){},185:function(e,t){},203:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(44),c=n.n(o),l=(n(135),n(45)),i=n(46),m=n(50),u=n(47),s=n(51),d=(n(137),n(138),n(206)),f=n(208),p=n(207),E=n(13),h=n(106),v=n.n(h),g=function(e){return e?(/^[?#]/.test(e)?e.slice(1):e).split("&").reduce(function(e,t){var n=t.split("="),a=Object(E.a)(n,2),r=a[0],o=a[1];return e[r]=o?decodeURIComponent(o.replace(/\+/g," ")):"",e},{}):{}},b=function(e){return v()(e).format("h:mm a")},O=r.a.createContext();function y(e){var t=e.users;return r.a.createElement("div",{className:"chat__sidebar"},r.a.createElement("h3",null,"People"),r.a.createElement("div",{id:"users"},r.a.createElement("ol",null,t.map(function(e,t){return r.a.createElement("li",{key:t},e)}))))}function x(e){var t=e.messages;return r.a.createElement("div",null,t.length>0&&t.map(function(e,t){return r.a.createElement("li",{key:t,className:"message"},r.a.createElement("div",{className:"message__title"},r.a.createElement("h4",null,e.from),r.a.createElement("span",null,b(e.createdAt))),r.a.createElement("div",{className:"message_body"},r.a.createElement("p",null,e.text)))}))}function j(e){var t=Object(a.useState)([]),n=Object(E.a)(t,2),o=n[0],c=n[1],l=Object(a.useState)([]),i=Object(E.a)(l,2),m=i[0],u=i[1],s=Object(a.useState)(""),d=Object(E.a)(s,2),f=d[0],p=d[1],h=Object(a.useContext)(O);return Object(a.useEffect)(function(){var t=g(e.location.search);return h.emit("join",t,function(e){e&&console.log(e)}),h.on("newMessage",function(e){var t=o;t.push(e),c(t)}),h.on("updateUserList",function(e){u(e)}),function(e){h.close()}},o||m),r.a.createElement("div",{className:"chat"},r.a.createElement(y,{users:m}),r.a.createElement("div",{className:"chat__main"},r.a.createElement("ol",{id:"messages",className:"chat__messages"},r.a.createElement(x,{messages:o})),r.a.createElement("div",{className:"chat__footer"},r.a.createElement("form",{id:"message-form"},r.a.createElement("input",{name:"message",type:"text",placeholder:"Message",autoFocus:!0,autoComplete:"off",onChange:function(e){return p(e.target.value)},value:f}),r.a.createElement("button",{onClick:function(e){e.preventDefault(),h.emit("createMessage",{from:"user",text:f},function(){var e;p(""),(e=document.getElementById("messages")).scrollHeight>e.clientHeight&&(e.scrollTop=e.scrollHeight)})}},"Send")),r.a.createElement("button",{id:"send-location"},"Send location"))))}var w=n(62);function C(e){var t=Object(a.useState)({name:"",room:""}),n=Object(E.a)(t,2),o=n[0],c=n[1];return Object(a.useEffect)(function(){e.user&&void 0===C&&(window.location.href="/apps/chat")}),r.a.createElement("div",{className:"centered-form__form"},r.a.createElement("form",null,r.a.createElement("div",{className:"form-field"},r.a.createElement("h3",null,"Create room chat")),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Room name:"),r.a.createElement("input",{type:"text",name:"room",value:o.room,onChange:function(e){return c(Object(w.a)({},o,{room:e.target.value}))}})),r.a.createElement("div",{className:"form-field"},r.a.createElement("button",{onClick:function(t){t.preventDefault(),e.submitUserInfo(e.user.name,o.room),e.history.push("/apps/chat/room?name=".concat(e.user.name,"&room=").concat(o.room))}},"Join"))))}var k=C,N=n(27),_=n(43),S=function(e){return e.get("chat")},I=n(18),R=function(e){var t=e.room,n=e.onJoinRoom;return r.a.createElement("div",{className:"cellContainer"},r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Room name:"),r.a.createElement("h3",null,t.name)),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Online users:"),r.a.createElement("h3",null,t.users.length)),r.a.createElement("button",{onClick:n},"Join"))},T=function(e){var t=e.rooms,n=e.handleJoinRoom;return r.a.createElement("div",null,t.length>0?t.map(function(e,t){return r.a.createElement(R,{room:e,key:t,onJoinRoom:function(t){return n(e)}})}):r.a.createElement("div",null,r.a.createElement("p",null,"No online rooms")))},M=Object(_.a)(Object(_.a)(S,function(e){return{rooms:e.get("rooms"),user:e.get("user")}}),function(e){return{rooms:e.rooms,user:e.user}}),U=Object(N.b)(M,function(e){return{submitUserInfo:function(t,n){return e(function(e,t){return{type:"SUBMIT_CURRENT_CHAT_USER",payload:{name:e,room:t}}}(t,n))},getOnlineRoomChat:function(t){return e(function(e){return{type:"GET_CHAT_ROOM_LIST",payload:e}}(t))}}})(function(e){var t=Object(a.useContext)(O);return Object(a.useEffect)(function(){t.on("updateRoomList",function(t){e.getOnlineRoomChat(t)})}),r.a.createElement("div",{className:"room_list"},e.user.name?r.a.createElement("div",null,r.a.createElement(T,{handleJoinRoom:function(t){e.submitUserInfo(t,e.user.name),e.history.push("/apps/chat/room?name=".concat(e.user.name,"&room=").concat(t.name))},rooms:e.rooms}),r.a.createElement(C,e)):r.a.createElement(I.c,{initialValues:{name:""},onSubmit:function(t){e.submitUserInfo(t.name,"")}},function(e){var t=e.isSubmitting;return r.a.createElement(I.b,null,r.a.createElement("div",{className:"centered-form__form"},r.a.createElement("h3",null,"Login"),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Name:"),r.a.createElement(I.a,{type:"text",name:"name"})),r.a.createElement("div",{className:"form-field"},r.a.createElement("button",{disabled:t},"Join"))))}))}),$=function(){return r.a.createElement("div",null,r.a.createElement(p.a,{exact:!0,path:"/apps/chat",component:U}),r.a.createElement(p.a,{exact:!0,path:"/apps/chat/join",component:k}),r.a.createElement(p.a,{exact:!0,path:"/apps/chat/room",component:j}))},A=n(113),L=n.n(A),J=function(e){return r.a.createElement("div",null,r.a.createElement("strong",null,"Hello world."),r.a.createElement(d.a,{to:"/my-work"},r.a.createElement("h3",null,"My work")))},P=n(114),q=n(12),H=n(17),B=n(61),D=n(15),Q=n(14),W=n.n(Q),G=n(115),V=n.n(G),z=function(){return r.a.createElement("img",{className:"loading",src:V.a})};function F(){var e=Object(q.a)(["\n  border-radius: 10px;\n  width: 700px;\n  height: 30px;\n  margin-left: 38px;\n  margin-bottom: 20px;\n  padding: 10px;\n  outline: none;\n"]);return F=function(){return e},e}function K(){var e=Object(q.a)(["\n  display: flex;\n  padding: 8px;\n  border-radius: 10px;\n  background-color: #f2f3f5;\n  align-items: center;\n  .comment-text {\n    margin-left: 15px;\n    width: 600px;\n  }\n  .comment-author {\n    font-weight: bold;\n  }\n  .delete-comment {\n    margin-left: auto;\n  }\n  width: 700px;\n  min-height: 40px;\n  margin: 0 auto;\n  margin-bottom: 12px;\n"]);return K=function(){return e},e}function X(){var e=Object(q.a)(["\n  query($postId: String, $first: Int, $after: String) {\n    comments(\n      postId: $postId\n      first: $first\n      after: $after\n      orderBy: createdAt_DESC\n    ) {\n      id\n      text\n      author {\n        id\n        name\n      }\n    }\n  }\n"]);return X=function(){return e},e}function Y(){var e=Object(q.a)(["\n  mutation($id: String!) {\n    deleteComment(id: $id) {\n      id\n    }\n  }\n"]);return Y=function(){return e},e}function Z(){var e=Object(q.a)(["\n  mutation($text: String!, $post: String!) {\n    createComment(data: { text: $text, post: $post }) {\n      id\n    }\n  }\n"]);return Z=function(){return e},e}var ee=W()(Z()),te=W()(Y()),ne=W()(X()),ae=function(e){var t=e.postId,n=e.isRefetch,a=[];return r.a.createElement("div",null,r.a.createElement(D.Query,{query:ne,fetchPolicy:"network-only",variables:{postId:t,first:5}},function(e){var o=e.loading,c=e.error,l=e.data,i=e.refetch,m=e.fetchMore;return a=l.comments,o?r.a.createElement("p",null,"Loading ... "):c?r.a.createElement("p",null,"ERROR"):(n&&i(),r.a.createElement("div",null,l.comments&&l.comments.map(function(e,n){return r.a.createElement(oe,{key:n},r.a.createElement("div",{className:"comment-author"},e.author.name),r.a.createElement("div",{className:"comment-text"},r.a.createElement("strong",null,e.text)),r.a.createElement(D.Mutation,{mutation:te,refetchQueries:[{query:ne,variables:{postId:t,first:5}}]},function(t,n){n.loading,n.error,n.data;return r.a.createElement("div",{className:"delete-comment",onClick:function(){return t({variables:{id:e.id}})}},r.a.createElement("i",{className:"fas fa-minus-circle"}))}))}),r.a.createElement("a",{href:"#",onClick:function(){m({query:ne,variables:{postId:t,first:5,after:a[a.length-1].id},updateQuery:function(e,t){var n=t.fetchMoreResult;return n?(a=n.comments,{comments:[].concat(Object(B.a)(e.comments),Object(B.a)(n.comments))}):e}})}},"View more comments")))}))},re=function(e){var t=e.postId,n=e.onCompleted,o=Object(a.useState)(""),c=Object(E.a)(o,2),l=c[0],i=c[1];return r.a.createElement(D.Mutation,{mutation:ee,onCompleted:n},function(e,n){n.loading,n.error;return r.a.createElement("form",{onSubmit:function(n){n.preventDefault(),e({variables:{text:l,post:t}}),i("")}},r.a.createElement(ce,{type:"text",placeholder:"Write a comment",value:l,onChange:function(e){i(e.target.value)}}))})},oe=H.a.div(K()),ce=H.a.input(F()),le=function(e){var t=e.postId,n=Object(a.useState)(!1),o=Object(E.a)(n,2),c=o[0],l=o[1];return r.a.createElement("div",null,r.a.createElement(re,{postId:t,onCompleted:function(e){l(!0)}}),r.a.createElement(ae,{postId:t,isRefetch:c}))};function ie(){var e=Object(q.a)(["\n  display: flex;\n  flex-direction: column;\n  background-color: white;\n  border-radius: 5px;\n  border-style: solid;\n  border-color: #f2f3f5;\n  width: 800px;\n  height: auto;\n  margin-bottom: 10px;\n  p {\n    margin-top: 20px;\n    text-align: center;\n  }\n  padding: 10px;\n  h5 {\n    padding: 10px;\n  }\n"]);return ie=function(){return e},e}var me=H.a.div(ie()),ue=function(e){var t=e.id,n=e.title,o=e.body,c=Object(a.useState)(!1),l=Object(E.a)(c,2),i=l[0],m=l[1];return r.a.createElement(me,null,r.a.createElement("h3",null,n),r.a.createElement("h5",null,o),r.a.createElement("p",{onClick:function(e){return m(!i)}},"Comments"),i&&r.a.createElement(le,{postId:t}))},se=function(e){var t=e.title;return r.a.createElement("h3",null,t)};function de(){var e=Object(q.a)(["\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  background-color: #f2f3f5;\n"]);return de=function(){return e},e}function fe(){var e=Object(q.a)(["\n  query GetPostList {\n    posts {\n      id\n      title\n      body\n      comments {\n        id\n        text\n        author {\n          id\n          name\n        }\n      }\n    }\n  }\n"]);return fe=function(){return e},e}var pe=W()(fe());function Ee(){return r.a.createElement(D.Query,{query:pe,fetchPolicy:"network-only"},function(e){var t=e.data,n=e.loading,a=e.error;e.fetchMore;return n?r.a.createElement(z,null):a?r.a.createElement("p",null,"ERROR"):r.a.createElement(he,null,r.a.createElement(se,{title:"New posts"}),t.posts&&t.posts.map(function(e,t){var n=Object(P.a)({},e);return r.a.createElement(ue,Object.assign({key:t},n))}))})}var he=H.a.div(de());function ve(){var e=Object(q.a)(["\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-bottom: 30px;\n  flex-direction: column;\n"]);return ve=function(){return e},e}function ge(){var e=Object(q.a)(["\n  query GetPostDetails($postId: String) {\n    post(id: $postId) {\n      id\n      title\n      body\n      comments {\n        id\n        text\n        author {\n          id\n          name\n        }\n      }\n    }\n  }\n"]);return ge=function(){return e},e}var be=W()(ge()),Oe=H.a.div(ve()),ye=function(e){return r.a.createElement(D.Query,{query:be,variables:{postId:e.match.params.postId}},function(e){var t=e.loading,n=e.error,a=e.data;return t?r.a.createElement("p",null,"Loading..."):n?r.a.createElement("p",null,"Error"):a.post&&r.a.createElement(Oe,null,r.a.createElement("p",null,a.post.title),r.a.createElement("p",null,a.post.body),r.a.createElement("p",null,"Comments:"),a.post.comments.length>0&&a.post.comments.map(function(e){var t=e.content,n=e.author,a=e.id;return r.a.createElement("div",{key:a},r.a.createElement("h4",null,t),r.a.createElement("h4",null,n.name))}))})},xe=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"login-container"},r.a.createElement(I.c,{initialValues:{username:"",password:""},onSubmit:function(e){}},function(e){var t=e.isSubmitting;return r.a.createElement(I.b,null,r.a.createElement("div",{className:"centered-form__form"},r.a.createElement("h3",null,"Login"),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Name:"),r.a.createElement(I.a,{type:"text",name:"name"})),r.a.createElement("div",{className:"form-field"},r.a.createElement("label",null,"Password:"),r.a.createElement(I.a,{type:"text",name:"password"})),r.a.createElement("div",{className:"form-field"},r.a.createElement("button",{disabled:t},"Login"))))}))}}]),t}(a.Component),je=n(121)("https://node-chat-server-by-lee.herokuapp.com/"),we=function(e){return r.a.createElement("div",null,r.a.createElement(d.a,{to:"/about"},r.a.createElement("strong",null,"About")))},Ce=function(e){return r.a.createElement("div",null,r.a.createElement("h3",null,"My apps"),r.a.createElement("span",null,r.a.createElement("img",{src:L.a,height:"40px",width:"40px"})),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("a",{href:"/apps/chat"},r.a.createElement("strong",null,"Chat app"))),r.a.createElement("li",null,r.a.createElement(d.a,{to:"/apps/posts"},r.a.createElement("strong",null,"Posts")))),r.a.createElement("div",null))},ke=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(O.Provider,{value:je},r.a.createElement(f.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(p.a,{exact:!0,path:"/",component:J}),r.a.createElement(p.a,{exact:!0,path:"/my-work",component:Ce}),r.a.createElement(p.a,{exact:!0,path:"/about",component:we}),r.a.createElement(p.a,{exact:!0,path:"/apps/posts",component:Ee}),r.a.createElement(p.a,{path:"/apps/post/:postId",component:ye}),r.a.createElement(p.a,{path:"/apps",component:$}),r.a.createElement(p.a,{path:"/login",component:xe}))))}}]),t}(a.Component),Ne=Object(N.b)()(ke),_e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Se(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Ie=n(122),Re=n.n(Ie),Te=n(28),Me=n(23),Ue=n(123),$e=n(128),Ae=n(124),Le=Object(Me.fromJS)({location:null});function Je(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Le;return(arguments.length>1?arguments[1]:void 0).type,e}var Pe=Object(Me.fromJS)({rooms:[],user:{}});function qe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_CHAT_ROOM_LIST":return e.set("rooms",t.payload);case"SUBMIT_CURRENT_CHAT_USER":return e.set("user",{name:t.payload.name,room:t.payload.room});default:return e}}var He=n(22),Be=n.n(He),De=n(21),Qe=Be.a.mark(Ge),We=Be.a.mark(Ve);function Ge(e){return Be.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(De.b)({type:"UPDATE_CHAT_ROOM_LIST",payload:e.payload});case 2:case"end":return t.stop()}},Qe,this)}function Ve(){return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(De.a)([Object(De.d)("GET_CHAT_ROOM_LIST",Ge)]);case 2:case"end":return e.stop()}},We,this)}var ze=Ve,Fe=Be.a.mark(Ke);function Ke(){return Be.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,[Object(De.c)(ze)];case 2:case"end":return e.stop()}},Fe,this)}var Xe=Object($e.a)();var Ye=new(n(127).a)({uri:"https://lee-graphql-blogging-server.herokuapp.com/",headers:{authorization:"Bearer ".concat(localStorage.getItem("token"))}}),Ze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=[Xe,Object(Ue.routerMiddleware)(t)],a=[Te.a.apply(void 0,n)],r=Te.c,o=Object(Te.d)(Object(Ae.combineReducers)({route:Je,chat:qe}),Object(Me.fromJS)(e),r.apply(void 0,a));return Xe.run(Ke),o}({},Re()());c.a.render(r.a.createElement(D.ApolloProvider,{client:Ye},r.a.createElement(N.a,{store:Ze},r.a.createElement(Ne,null))),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");_e?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Se(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Se(e)})}}()}},[[130,2,1]]]);
//# sourceMappingURL=main.21fa01a1.chunk.js.map